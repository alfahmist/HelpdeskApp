CREATE PROCEDURE [dbo].[SP_ResponsedTicket]
AS
BEGIN
	SELECT	tic.Id AS 'Ticket Id',
				tic.[Description] AS 'Description', 
				TMessage.[Subject] AS 'Ticket SUbject', TMessage.[Message] AS 'Ticket Message',
				tic.CreatedDate AS 'Open Date', 
				tic.EmployeeId AS 'RequestorID',
				emp.[Name] AS 'Requestor Name',
				st.[Name] AS 'Status',
				ts.StatusDate AS 'Status Date',
				tr.Solution AS 'Solution',
				tr.ResponDate AS 'Solution Date',
				response.[Name] AS 'Respondance Name'
			FROM TB_T_Ticket as tic 
			JOIN TB_T_TicketStatus AS ts ON ts.TicketId = tic.Id 
			JOIN TB_M_Status AS st ON ts.StatusId = st.Id
			JOIN TB_M_Employee as emp ON emp.Id = tic.EmployeeId
			JOIN TB_T_TicketMessage AS TMessage ON TMessage.TicketId = tic.Id
			JOIN TB_T_TicketResponse AS tr ON tic.Id = tr.TicketId
			JOIN TB_M_Employee AS response ON tr.EmployeeId = response.Id
			WHERE ts.StatusId = 3;
END
